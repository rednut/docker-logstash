filter {

  if [type] == "syslog" and [facility_label] == "security/authorization" {
    
    grok {
        match => [ 
	  #  Failed password for root from 122.225.109.204 port 30976 ssh2
	  "message" ,  "Failed password for %{USERNAME:auth_user} from %{IPORHOST:source_ip} port %{POSINT:source_port} %{USERNAME:dest_port}.*",
	  "message" ,  "Failed password for invalid %{USERNAME:auth_user_invalid} from %{IPORHOST:source_ip} port %{POSINT:source_port} %{USERNAME:dest_port}.*"


	]
	add_tag => [  "auth", "failure" ]
	tag_on_failure => [ ]
	break_on_match => true	
    }
    geoip {
                        source => "source_ip"
                        target => "geoip"
                        add_tag => [ "geoip" ]
                        add_field => [
                           "[geoip][coordinates]", "%{[geoip][longitude]}",
                           "[geoip][coordinates]", "%{[geoip][latitude]}"
                         ]
    }
	 mutate {
                      convert => [
                        "[geoip][coordinates]", "float"
			]
	}

  }
}
