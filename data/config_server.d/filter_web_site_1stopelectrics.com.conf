filter {
	if [type] == "nginx" and [http_host] == "www.1stopelectrics.com" {





		#
		# images 
		#
		grok {
			# "/img/stockline/XFC20NW/1/0x300/XFC20NW+1.jpg"
			match => [ 
"uripath", "^/img/%{DATA:image_type}/%{DATA:image_id}/%{NUMBER:image_index:integer}/(?:%{NUMBER:image_width:integer}?)x%{NUMBER:image_height:integer}/%{DATA:image_filename}(?:\.%{DATA:image_extension})$"
			]
			add_field => [ "resource", "image" ]
			add_tag => [ "image" ]
			tag_on_failure => []
		}


		#
		# products
		# url: ^/product/%{DATA:stockcode}/%{DATA:product_name}(?:\/)$
		#
		grok {
			match => [ 
				"uripath", "^/product/%{DATA:stockcode}/%{GREEDYDATA:product_name}$"
			]
			add_field => [ "resource", "product" ]
			add_tag => [ "product", "stockcode" ]
			tag_on_failure => []
		}
		#


		#
		# categories
		# url: ^/category/%{NUMBER:category_id}/%{GREEDYDATA:category_name}$	
		#
		grok {
			match => [ "uripath", "^/category/%{NUMBER:category_id}/%{GREEDYDATA:category_name}$" ]
			add_field => [ "resource", "category" ]
			add_tag => [ "category" ]
			tag_on_failure => []
		}
		#


		#
		# search: ^/search/%{DATA:search_string}^
		#
		grok {
                        match => [ "uripath", "^/search(?:/%{GREEDYDATA:search_string})?" ]
                        add_field => [ "resource", "search" ]
                        add_tag => [ "search" ]
			tag_on_failure => []
                }
		#

		grok { 
			match => [ 
				"uripath", "^/forgottenpassword?" 
				]
			add_field => [ "resource", "forgottenpassword" ]
                        add_tag => [ "forgottenpassword" ]
                        tag_on_failure => []
		}
		#


		grok {
                        match => [ "uripath", "^/document/%{GREEDYDATA:document_name}" ]
                        add_field => [ "resource", "document" ]
                        add_tag => [ "document" ]
                        tag_on_failure => []
                }
                #


		grok {
                        match => [ "uripath", "^/contact(?:/)?$" ]
                        add_field => [ "resource", "contact" ]
                        add_tag => [ "contact" ]
                        tag_on_failure => []
                }
                #

		grok {
                        match => [ "uripath", "^/cart_actioni\.php" ]
                        add_field => [ "resource", "cart_action" ]
                        add_tag => [ "cart_action" ]
                        tag_on_failure => []
                }
                #

	   	grok {
                        match => [ "uripath", "^/shoppingcart(?:\.php)?" ]
                        add_field => [ "resource", "shoppingcart" ]
                        add_tag => [ "shoppingcart" ]
                        tag_on_failure => []
                }

		grok {
                        match => [ "uripath", "^/paymentdetails$" ]
                        add_field => [ "resource", "paymentdetails" ]
                        add_tag => [ "paymentdetails" ]
                        tag_on_failure => []
                }
                #
   		
		grok {
                        match => [ "uripath", "^/myaccount$" ]
                        add_field => [ "resource", "myaccount" ]
                        add_tag => [ "myaccount" ]
                        tag_on_failure => []
                }
                #

   		grok {
                        match => [ "uripath", "^/myaccount/history$" ]
                        add_field => [ "resource", "myaccount_history" ]
                        add_tag => [ "myaccount", "history" ]
                        tag_on_failure => []
                }
                #

	   	grok {
                        match => [ "uripath", "^/3DCallbackHandler\.php$" ]
                        add_field => [ "resource", "3dcallback" ]
                        add_tag => [ "3dcallback" ]
                        tag_on_failure => []
                }
                #

   		grok {
                        match => [ "uripath", "^/ajax/%{GREEDYDATA:ajax_query}$" ]
                        add_field => [ "resource", "ajax" ]
                        add_tag => [ "ajax" ]
                        tag_on_failure => []
                }
                #

   		grok {
                        match => [ "uripath", "^/_google_base_feeder\.php$" ]
                        add_field => [ "resource", "googlefeed" ]
                        add_tag => [ "googlefeed" ]
                        tag_on_failure => []
                }
                #

		grok {
                        match => [ "uripath", "^/signup(?:\.php)?" ]
                        add_field => [ "resource", "signup" ]
                        add_tag => [ "signup" ]
                        tag_on_failure => []
                }
                #

		grok {
                        match => [ "uripath", "^/login$" ]
                        add_field => [ "resource", "login" ]
                        add_tag => [ "login" ]
                        tag_on_failure => []
                }
                #

		grok {
                        match => [ "uripath", "^/orders(?:/)?$" ]
                        add_field => [ "resource", "orders" ]
                        add_tag => [ "orders" ]
                        tag_on_failure => []
                }
                #
   		
		grok {
                        match => [ "uripath", "^/sms/delivery_recipt\.php$" ]
                        add_field => [ "resource", "sms_delivery" ]
                        add_tag => [ "sms", "delivery" ]
                        tag_on_failure => []
                }
                #

   		grok {
                        match => [ "uripath", "^/document/ordersuccess$" ]
                        add_field => [ "resource", "ordersuccess" ]
                        add_tag => [ "ordersuccess" ]
                        tag_on_failure => []
                }
                #

	   	grok {
                        match => [ "uripath", "^/orderview/%{DATA:order_guid}$" ]
                        add_field => [ "resource", "forgottenpassword" ]
                        add_tag => [ "forgottenpassword" ]
                        tag_on_failure => []
                }
                #

		grok {
                        match => [ "uripath", "^/orders/orderview\.php" ]
                        add_field => [ "resource", "orderview" ]
                        add_tag => [ "orderview" ]
                        tag_on_failure => []
                }
                #

  		grok {
                        match => [ "uripath", "^/$" ]
                        add_field => [ "resource", "homepage" ]
                        add_tag => [ "homepage" ]
                        tag_on_failure => []
                }
                #

                #
		if [resource] == "search" {
			urldecode {
				field => "search_string"
			}
		}

		

	}


}
